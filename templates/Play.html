<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Play</title>
    <link rel="stylesheet" href="Play.css">

    <script src="../scripts/Game%20Mods.js"></script>
</head>
<body onload="timer">



<a hidden id="wait" href="WaitDuring.html"></a>
<a hidden id="done" href="GameEnd.html"></a>



<div class="timerwrapper">
    <div class="shrinking"></div>
</div>

<div class="pts" id="points">
    <p id="point">Points: 0</p>
</div>

<div>
    <p id="timer" class="timeBox"></p>
</div>

<div class="correctAnswers"></div>

<div>
    <h3 id="question" class="question"></h3>
</div>

<div class="searchFont" id="answer" style="overflow: hidden; padding-right: 2em">
    <input type="text" id="searchBox" placeholder="Type answer here..."/>
</div>

<div>
    <button type="button" id="enterBox" class="buttonFont" onclick="onSubmit(answers,player)">Enter</button>
</div>

<script>


    //Choses the correct question from the local storage array
    let questionList= JSON.parse(localStorage.getItem("questionList"));
    let question=questionList[JSON.parse(localStorage.getItem("questionsNum"))-1];
    console.log(question);
    document.getElementById('question').textContent= question;

    ///Pulls answer from input box
    let input = document.getElementById("answer");
    input.addEventListener("keydown", function(event) {
        if (event.code === 'Enter') {
            document.getElementById("submit").click();
        }
    });
    ///Compares the answers and modified the player object
    function getAns() {
        let ans = document.getElementById("answer");
        return(ans.value);
    }
    document.getElementById('question').textContent= question;
    let answers=['doc','grumpy','happy','sleepy','dopey','bashful','sneezy']; ///Pull From Server
    let player ={
        usrAnswers:[],
        score:0
    };

    function onSubmit(answers,player){
        player.score+=checkAns(getAns(),player.usrAnswers,answers);
        player.usrAnswers.push(getAns());
        console.log(player.score,player.usrAnswers);
        document.getElementById('answer').value='';
        document.getElementById("points").textContent = ('Points: ' + player.score);

    };

    //Timer Things
    let timeleft=30;
    document.getElementById("timer").textContent = timeleft;
    let timer = setInterval(function(){
        timeleft--;
        document.getElementById("timer").textContent = timeleft;
        if(timeleft <= 0) {
            questionsLeft=localStorage.getItem('questionsNum')-1;
            localStorage.setItem('score',JSON.stringify(JSON.parse(localStorage.getItem('score'))+player.score));
            if (questionsLeft===0){
                document.getElementById('done').click();
            }else{
                localStorage.setItem('questionsNum',questionsLeft);

                document.getElementById('wait').click();
            }

        }
    },1000);

    ///Edits the 4 lists (max 7 items) will have to make them all nice and shit in CSS later

    ///The answers will be pulled from the server
    //Show something to indicate the player got a pint
    
</script>
</body>
</html>